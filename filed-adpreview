FROM tiangolo/uwsgi-nginx:python3.7

RUN apt-get update && apt-get -y install unixodbc-dev

ENV UWSGI_CHEAPER 4
ENV UWSGI_PROCESSES 64

ENV LISTEN_PORT 80
ENV UWSGI_INI /ad_preview/uwsgi.ini

COPY ./AdPreview/ad_preview /ad_preview

COPY ./Core /core

EXPOSE 80

WORKDIR /ad_preview
RUN pip install --upgrade pip && pip3 install -r requirements.txt